<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:clx="http://java.sun.com/jsf/composite/components">
<ui:composition template="../templates/main.xhtml">

	<ui:param name="activeDashboard" value="active" />
	<ui:param name="pageIcon" value="money" />
	<ui:param name="pageTitle" value="LANÇAMENTO DE DESPESA" />

	<ui:define name="body">
		<clx:buttonsCrud id="btnsUp" bean="#{beanContaLancamentos}"></clx:buttonsCrud>
		<p:panel header="Lançamento de despesas" id="pnlMain">
			<p:panelGrid  columns="1">
				Data Vencimento
				<clx:dateCalendar id="txtDtVencimento"
					value="#{beanContaLancamentos.contaLancamento.dtVencimento}" />
				Data despesa					
				<clx:dateCalendar id="txtData"
					value="#{beanContaLancamentos.contaLancamento.data}" />
				Valor:	
				<clx:currency id="txtValor"
					value="#{beanContaLancamentos.contaLancamento.valor}" />
				Juros:
				<clx:currency id="txtJuros"
					value="#{beanContaLancamentos.contaLancamento.valorJuros}" />
				Centro de Custo:
				<p:selectOneMenu id="centro" converter="#{centroDeCustoConverter}"
					value="#{beanContaLancamentos.contaLancamento.centroDeCusto}"
					required="true" requiredMessage="Informe o centro de custo">
					<f:selectItem itemLabel="CENTRO DE CUSTO" itemValue="-1" />
					<f:selectItems value="#{beanContaLancamentos.centroDeCusto}" var="centro" itemValue="#{centro}" itemLabel="#{centro.descricao}"/>
				</p:selectOneMenu>			
				Forma Pagamento:
				
				<p:panelGrid  id="pnlCartao" columns="1">
				<p:selectOneMenu id="pagto"
					value="#{beanContaLancamentos.contaLancamento.formaPgto}"
					required="true"
					requiredMessage="Informe qual foi a forma de pagamento">
					<f:selectItem itemLabel="FORMA PAGAMENTO" itemValue="-1"/>
					<f:selectItems value="#{beanContaLancamentos.formaPagamento}"
						var="pgto" itemLabel="#{pgto.descricao}" />
						<p:ajax event="change" listener="#{beanContaLancamentos.verificarSeMostraDadosCartao}" update="pnlCartao" />
				</p:selectOneMenu>
				
				<p:outputLabel value="Número parcelas" for="txtParcelas"
						rendered="#{beanContaLancamentos.habilitarDadosCartao}" />
					<p:inputText id="txtParcelas"
						value="#{beanContaLancamentos.contaLancamento.parcelas}"
						maxlength="2"
						required="#{beanContaLancamentos.habilitarDadosCartao}"
						requiredMessage="Informa as Parcelas mesmo que seja uma."
						rendered="#{beanContaLancamentos.habilitarDadosCartao}">
						<f:convertNumber integerOnly="true" />
					</p:inputText>
					<p:outputLabel value="Cartão" id="lblCartao" for="cboCartao" rendered="#{beanContaLancamentos.habilitarDadosCartao}"/>
					<p:selectOneMenu id="cboCartao"
						converter="#{cartaoCreditoDebitoConverter}"
						value="#{beanContaLancamentos.contaLancamento.cartaoCreditoDebito}"
						required="#{beanContaLancamentos.habilitarDadosCartao}"
						rendered="#{beanContaLancamentos.habilitarDadosCartao}"
						requiredMessage="Informe o cartão por favor">
						<f:selectItem itemLabel="Selecione..." itemValue="#{null}" />
						<f:selectItems var="cartao"
							itemLabel="#{cartao.codigo} - #{cartao.descricao}"
							value="#{beanContaLancamentos.cartoesAtivos}"
							itemValue="#{cartao}" />
					</p:selectOneMenu>
					</p:panelGrid>
			</p:panelGrid>
			
			<p:panelGrid columns="1">	
				<p:inputTextarea id="descricao" value="#{beanContaLancamentos.contaLancamento.descricao}" required="true"
				requiredMessage="Diga a descrição" placeholder="Breve descrição"/>
			</p:panelGrid>
			<p:panel header="Lançamentos do Mês">
					<p:dataTable id="lancamentos" var="lan" value="#{beanContaLancamentos.lancamentos}" resizableColumns="true" style="margin-bottom:20px" 
					selectionMode="single" selection="#{beanContaLancamentos.selectedContaLancamento}"  rowKey="#{lan.codigo}" rows="10" scrollable="true" >
						
						<f:facet name="header">
            				Lançamentos do Mês
        				</f:facet>
						<p:column headerText="Descrição">
							<h:outputText value="#{lan.descricao}" />
						</p:column>
						<p:column headerText="Data">
							<h:outputText value="#{lan.data}" >
								<f:convertDateTime pattern="dd/MM/yyyy" />
							</h:outputText>
						</p:column>
						<p:column headerText="Valor $" style="text-align: right;width:115px;" >
							<h:outputText value="#{lan.valor}" >
							 	<f:convertNumber pattern="##,###.00" />
							</h:outputText>
						</p:column>
						
					</p:dataTable>
				</p:panel>
		</p:panel>
	</ui:define>
</ui:composition>
</html>